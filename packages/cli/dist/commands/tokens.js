import { resolve } from 'node:path';
import { SystemWorkspace } from '@designagent/core';
export async function tokensCommand(options) {
    const workspacePath = resolve(process.cwd(), options.workspace);
    const platform = options.platform;
    const theme = options.theme;
    const format = options.format;
    // Validate inputs
    if (!['web', 'rn'].includes(platform)) {
        console.error('Error: Invalid platform. Use "web" or "rn".');
        process.exit(1);
    }
    if (!['light', 'dark'].includes(theme)) {
        console.error('Error: Invalid theme. Use "light" or "dark".');
        process.exit(1);
    }
    if (!['json', 'css', 'ts'].includes(format)) {
        console.error('Error: Invalid format. Use "json", "css", or "ts".');
        process.exit(1);
    }
    const workspace = new SystemWorkspace(workspacePath);
    // Check workspace exists
    if (!(await workspace.exists())) {
        console.error('Error: Workspace not found.');
        process.exit(1);
    }
    try {
        const tokens = await workspace.compileTokens({ platform, theme });
        switch (format) {
            case 'json':
                console.log(JSON.stringify(tokens, null, 2));
                break;
            case 'css':
                console.log(':root {');
                for (const [key, value] of Object.entries(tokens)) {
                    const cssKey = key.replace(/\./g, '-');
                    console.log(`  --${cssKey}: ${value};`);
                }
                console.log('}');
                break;
            case 'ts':
                console.log('// Auto-generated by DesignAgent');
                console.log(`// Platform: ${platform}, Theme: ${theme}`);
                console.log('');
                console.log('export const tokens = {');
                for (const [key, value] of Object.entries(tokens)) {
                    const tsValue = typeof value === 'string' ? `'${value}'` : value;
                    console.log(`  '${key}': ${tsValue},`);
                }
                console.log('} as const;');
                console.log('');
                console.log('export type TokenKey = keyof typeof tokens;');
                break;
        }
    }
    catch (err) {
        console.error('Error compiling tokens:', err);
        process.exit(1);
    }
}
//# sourceMappingURL=tokens.js.map